<html>
  <head>
    <meta lang="jp" name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>Location-based AR.jsのテスト</title>
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/AR-js-org/AR.js/aframe/build/aframe-ar.js"></script>
    <script src="https://unpkg.com/aframe-look-at-component@0.8.0/dist/aframe-look-at-component.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/aframe-extras@6.1.1/dist/aframe-extras.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
    <script src="https://unpkg.com/aframe-extras@6.1.1/dist/aframe-extras.min.js"></script>
  </head>

  <body style="margin: 0; overflow: hidden;">
    <a-scene
      renderer="alpha: true;"
      background="transparent: true;"
      vr-mode-ui="enabled: false"
      embedded
      arjs="sourceType: webcam; debugUIEnabled: false;"
    >

      <a-assets>
        <img id="img001" src="./images/out_001.png" title="out001">
        <img id="img002" src="./images/out_002.png" title="out002">
        <img id="img003" src="./images/out_003.png" title="out003">
        <img id="img004" src="./images/out_004.png" title="out004">
        <img id="img005" src="./images/out_005.png" title="out005">
        <img id="img006" src="./images/out_006.png" title="out006">
        <img id="img007" src="./images/out_007.png" title="out007">
        <img id="img008" src="./images/out_008.png" title="out008">
        <img id="img009" src="./images/out_009.png" title="out009">
        <img id="img010" src="./images/out_010.png" title="out010">
      </a-assets>

      <a-entity
        gps-entity-place="latitude: 35.70468773985198; longitude: 139.638377606462;"
        position="0 50 0"
        scale="10 10 10"
        look-at="[gps-camera]">
          <a-image id="anime" src="#img001" transparent="true" alpha-test="0.5"></a-image>
      </a-entity>

      <!-- カメラ -->
      <a-camera gps-camera rotation-reader> </a-camera>
    </a-scene>
  </body>
  <script>
    let frame = 1;
    const maxFrame = 10;
    const animeImage = document.getElementById('anime');

    setInterval(() => {
      frame++;
      if(frame > maxFrame) {
        frame = 1;
      }
      const frameId = `#img${String(frame).padStart(3, '0')}`;
      animeImage.setAttribute('src', frameId);
    }, 100);
  </script>
  <!-- <script>
      window.addEventListener('load', () => {
        // 適当に場所を指定して緯度、経度を指定
        const lat = 35.7046486;
        const lon = 139.6383561;
        const apiKey = "85d58a3e59a7469a65d625479f26ff17";

        fetch(`https://api.openweathermap.org/data/2.5/weather?lat=${lat}&lon=${lon}&appid=${apiKey}&units=metric`)
          .then(response => response.json())
          .then(data => {
            // 天気
            const weather = data.weather[0].main;
            const imageAnchor = document.getElementById('weather-image-anchor');
            const imageEl = document.createElement('a-image');

            let imgId = "#unknown"; // デフォルト画像

            switch (weather) {
              case "Clear":
                imgId = "#sunny";
                break;
              case "Clouds":
                imgId = "#cloudy";
                break;
              case "Rain":
                imgId = "#rainy";
                break;
              case "Snow":
                imgId = "#snowy";
                break;
            }

            imageEl.setAttribute('src', imgId);
            imageEl.setAttribute('position', '0 50 0');
            imageEl.setAttribute('scale', '15 15 15');
            imageEl.setAttribute('title', weather);
            imageEl.setAttribute('look-at', '[gps-camera]');
            imageAnchor.appendChild(imageEl);

            // タップイベント
            imageEl.addEventListener('click', () => {
              const messageEl = document.createElement('a-text');
              messageEl.setAttribute('value', 'タップされました！');
              messageEl.setAttribute('position', '0 30 0');
              messageEl.setAttribute('scale', '10 10 10');
              messageEl.setAttribute('color', '#00ff00');
              messageEl.setAttribute('font-weight', 'bold');
              messageEl.setAttribute('look-at', '[gps-camera]');
              imageAnchor.appendChild(messageEl);
            });

            // 時間帯
            const now = new Date();
            const hour = now.getHours();
            let message = 'こんにちは！'; 

            if(hour >= 5 && hour < 11) {
              message = '5:00~10:59です';
            } else if(hour >= 11 && hour < 17) {
              message = '11:00~16:59です';
            } else if(hour >= 17 && hour < 19) {
              message = '17:00~18:59です';
            } else {
              message = '19:00~です'
            }

            const textAnchor = document.getElementById('time-text-anchor');
            const textEl = document.createElement('a-text');

            textEl.setAttribute('value', message);
            textEl.setAttribute('position', '0 50 0');
            textEl.setAttribute('scale', '20 20 20');
            textEl.setAttribute('align', 'center');
            textEl.setAttribute('color', '#ff0000');
            textEl.setAttribute('font-weight', 'bold');
            textEl.setAttribute('look-at', '[gps-camera]');

            textAnchor.appendChild(textEl);
          });

          // シャッターイベント
          const btn = document.getElementById('shutter-btn');
          let shutteredImgId = '#shuttered';

          btn.addEventListener('click', () => {
            const shutteredImage = document.createElement('a-image');
            shutteredImage.setAttribute('src', shutteredImgId);
            shutteredImage.setAttribute('position', '-10 -30 -10');
            shutteredImage.setAttribute('scale', '10 10 10');
            shutteredImage.setAttribute('rotate', '0 45 0');
            shutteredImage.setAttribute('look-at', '[gps-camera]');
            imageAnchor.appendChild(shutteredImage);
          });

        });
  </script> -->
</html>
